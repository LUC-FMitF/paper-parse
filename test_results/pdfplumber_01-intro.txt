
--- Page 1 ---
CIS 194: Homework 1
Due Monday, January 14
Whensolvingthehomework,strivetocreatenotjustcodethat
works,butcodethatisstylishandconcise. Seethestyleguideon
thewebsiteforsomegeneralguidelines. Trytowritesmallfunctions
whichperformjustasingletask,andthencombinethosesmaller
piecestocreatemorecomplexfunctions. Don’trepeatyourself: write
onefunctionforeachlogicaltask,andreusefunctionsasnecessary.
Besuretowritefunctionswithexactlythespecifiednameand
typesignatureforeachexercise(tohelpustestyourcode). Youmay
createadditionalhelperfunctionswithwhatevernamesandtype
signaturesyouwish.
1
Validating Credit Card Numbers
Haveyoueverwonderedhowwebsitesvalidateyourcreditcard
numberwhenyoushoponline? Theydon’tcheckamassivedatabase
ofnumbers,andtheydon’tusemagic. Infact,mostcreditproviders
relyonachecksumformulafordistinguishingvalidnumbersfrom
randomcollectionsofdigits(ortypingmistakes).
Inthissection,youwillimplementthevalidationalgorithmfor
creditcards. Itfollowsthesesteps:
• Doublethevalueofeveryseconddigitbeginningfromtheright.
Thatis,thelastdigitisunchanged;thesecond-to-lastdigitisdou-
bled;thethird-to-lastdigitisunchanged;andsoon. Forexample,
[1,3,8,6]becomes[2,3,16,6].
• Addthedigitsofthedoubledvaluesandtheundoubleddig-
itsfromtheoriginalnumber. Forexample,[2,3,16,6]becomes
2+3+1+6+6 = 18.
1
AdaptedfromthefirstpracticumassignedintheUniversityofUtrechtfunctional
programmingcoursetaughtbyDoaitseSwierstra,2008-2009.
--- Page 2 ---
cis 194: homework 1 2
• Calculatetheremainderwhenthesumisdividedby10. Forthe
aboveexample,theremainderwouldbe8.
Iftheresultequals0,thenthenumberisvalid.
Exercise 1 Weneedtofirstfindthedigitsofanumber. Definethe
functions
toDigits :: Integer -> [Integer]
toDigitsRev :: Integer -> [Integer]
toDigitsshouldconvertpositiveIntegerstoalistofdigits. (For0or
negativeinputs,toDigitsshouldreturntheemptylist.) toDigitsRev
shoulddothesame,butwiththedigitsreversed.
Example: toDigits 1234 == [1,2,3,4]
Example: toDigitsRev 1234 == [4,3,2,1]
Example: toDigits 0 == []
Example: toDigits (-17) == []
Exercise 2 Oncewehavethedigitsintheproperorder,weneedto
doubleeveryotherone. Defineafunction
doubleEveryOther :: [Integer] -> [Integer]
RememberthatdoubleEveryOthershoulddoubleeveryothernum-
berbeginningfromtheright,thatis,thesecond-to-last,fourth-to-last,
...numbersaredoubled.
Example: doubleEveryOther [8,7,6,5] == [16,7,12,5]
Example: doubleEveryOther [1,2,3] == [1,4,3]
Exercise 3 TheoutputofdoubleEveryOtherhasamixofone-digit
andtwo-digitnumbers. Definethefunction
sumDigits :: [Integer] -> Integer
tocalculatethesumofalldigits.
Example: sumDigits [16,7,12,5] = 1 + 6 + 7 + 1 + 2 + 5 = 22
Exercise 4 Definethefunction
validate :: Integer -> Bool
thatindicateswhetheranIntegercouldbeavalidcreditcardnum-
ber. Thiswilluseallfunctionsdefinedinthepreviousexercises.
Example: validate 4012888888881881 = True
Example: validate 4012888888881882 = False
--- Page 3 ---
cis 194: homework 1 3
2
The Towers of Hanoi
Exercise 5 TheTowersofHanoiisaclassicpuzzlewithasolution
thatcanbedescribedrecursively. Disksofdifferentsizesarestacked
⇓
onthreepegs;thegoalistogetfromastartingconfigurationwith
alldisksstackedonthefirstpegtoanendingconfigurationwithall
disksstackedonthelastpeg,asshowninFigure1.
Theonlyrulesare
Figure1:TheTowersofHanoi
• youmayonlymoveonediskatatime,and
• alargerdiskmayneverbestackedontopofasmallerone.
Forexample,asthefirstmoveallyoucandoismovethetopmost,
smallestdiskontoadifferentpeg,sinceonlyonediskmaybemoved
atatime.
Fromthispoint,itisillegaltomovetotheconfigurationshownin
Figure2:Avalidfirstmove.
Figure3,becauseyouarenotallowedtoputthegreendiskontopof
thesmallerblueone.
Tomove n discs(stackedinincreasingsize)frompeg a topeg b
usingpeg c astemporarystorage, Figure3:Anillegalconfiguration.
1. move n−1discsfrom a to c using b astemporarystorage
2. movethetopdiscfrom a to b
3. move n−1discsfrom c to b using a astemporarystorage.
Forthisexercise,defineafunctionhanoiwiththefollowingtype:
type Peg = String
type Move = (Peg, Peg)
hanoi :: Integer -> Peg -> Peg -> Peg -> [Move]
2 AdaptedfromanassignmentgiveninUPennCIS552,taughtbyBenjaminPierce
--- Page 4 ---
cis 194: homework 1 4
Giventhenumberofdiscsandnamesforthethreepegs,hanoi
shouldreturnalistofmovestobeperformedtomovethestackof
discsfromthefirstpegtothesecond.
Notethatatypedeclaration,liketype Peg = Stringabove,makes
atypesynonym. InthiscasePegisdeclaredasasynonymforString,
andthetwonamesPegandStringcannowbeusedinterchangeably.
Givingmoredescriptivenamestotypesinthiswaycanbeusedto
giveshorternamestocomplicatedtypes,or(ashere)simplytohelp
withdocumentation.
Example: hanoi 2 "a" "b" "c" == [("a","c"), ("a","b"), ("c","b")]
Exercise 6 (Optional)Whatiftherearefourpegsinsteadofthree?
Thatis,thegoalisstilltomoveastackofdiscsfromthefirstpegto
thelastpeg,withouteverplacingalargerdiscontopofasmaller
one,butnowtherearetwoextrapegsthatcanbeusedas“tempo-
rary”storageinsteadofonlyone. Writeafunctionsimilartohanoi
whichsolvesthisprobleminasfewmovesaspossible.
Itshouldbepossibletodoitinfarfewermovesthanwiththree
pegs. Forexample,withthreepegsittakes215−1 = 32767moves
totransfer15discs. Withfourpegsitcanbedonein129moves. (See
Exercise1.17inGraham,Knuth,andPatashnik,ConcreteMathematics,
seconded.,Addison-Wesley,1994.)